todo:
* check input tables.
* run mypy --strict