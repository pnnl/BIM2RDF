schema: '2.0'
stages:
  map:
    cmd: python -m mapping.speckle --inference=False --stream_id=Pritoni
    deps:
    - path: ../../ontologies/imported/223p.ttl
      hash: md5
      md5: e374bfa317d98e2d38c2f333ad6a5766
      size: 4054607
    - path: ../223p
      hash: md5
      md5: d61f27b42a75788befc5bd02ed12ecff.dir
      size: 17990
      nfiles: 10
    - path: ../src/mapping
      hash: md5
      md5: dcedf82ac831b25d5465b613a0024ec3.dir
      size: 72076
      nfiles: 11
    outs:
    - path: out.ttl
      hash: md5
      md5: b0cf8d246d573a1a990bbc6825334217
      size: 84382177
  upload_ontology:
    cmd: mapping-run-in inv graphdb.upload-graph --ttl ontology.ttl --name brick
    deps:
    - path: ontology.ttl
      md5: beb7b350bb20989d33ed1388b1bde35e
      size: 851853
  upload_data:
    cmd: graphdb-run-in python -m graphdb.tasks upload_graph out.ttl --delete=True  --name
      Pritoni
    deps:
    - path: out.ttl
      md5: 9c8ab26e18607b2a1d5496274f66155b
      size: 13619397
  infer:
    cmd: mapping-run-in python -X utf8 owlrl_patch.py --input_syntax=turtle --maximal
      --owlrl=yes --rdfs=yes --extras=yes --axioms=yes --serialization=turtle mapped.ttl  ontology.ttl
      > inferred.ttl
    deps:
    - path: mapped.ttl
      md5: 8550273359000692616534088923f780
      size: 1701475
    - path: ontology.ttl
      md5: beb7b350bb20989d33ed1388b1bde35e
      size: 851853
    outs:
    - path: inferred.ttl
      md5: 30c9997683f08ba1dd62b69453868641
      size: 5209324
  validate:
    cmd: mapping-run-in python pyshacl_err.py --shacl ../../test/proto-medoffice.ttl  -f
      turtle --iterate-rules --advanced -o validation.ttl  inferred.ttl
    deps:
    - path: ../../test/proto-medoffice.ttl
      md5: 4cc113962c8b1f99aa34d5a212282843
      size: 3500
    - path: inferred.ttl
      md5: 30c9997683f08ba1dd62b69453868641
      size: 5209324
    outs:
    - path: validation.ttl
      md5: 7aa4692047e43fff72291148daaf2975
      size: 153
  ontologies:
    cmd: ontologies-run-in dvc repro
    deps:
    - path: ../ontologies
      md5: 1c6d1de47270bfad7d6188fc7d1ceef4.dir
      size: 290181535
      nfiles: 670
  upload:
    cmd: python -m graphdb.tasks upload_graph out.ttl --delete=True  --name Pritoni
    deps:
    - path: out.ttl
      hash: md5
      md5: 0425537fdb09fd756c7496ab9a8857af
      size: 522566880
